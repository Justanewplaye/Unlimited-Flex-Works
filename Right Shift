-- ✅ Force HttpService to allow external requests (Prevents executor restrictions)
pcall(function()
    setfflag("HttpService", "true")
    setfflag("AllowHttpRequests", "true")
end)

local imageUrl = "https://raw.githubusercontent.com/Justanewplaye/Unlimited-Flex-Works/refs/heads/main/12e40e625eb48f14b4765cf26fc2993c.png"

-- ✅ Use syn.request() to safely fetch external images
local function fetchImage()
    if syn and syn.request then
        local response = syn.request({Url = imageUrl, Method = "GET"})
        if response and response.StatusCode == 200 then
            return imageUrl  -- ✅ External image loaded successfully!
        else
            warn("⚠️ Failed to fetch external image.")
            return nil
        end
    else
        warn("⚠️ syn.request not available. Your executor might not support it.")
        return nil
    end
end

-- ✅ Create GUI and button
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ShiftEmulatorGui"
screenGui.Parent = game:GetService("CoreGui")

local button = Instance.new("ImageButton")
button.Name = "ShiftButton"
button.Size = UDim2.new(0, 60, 0, 60)  -- Circular button (60x60 pixels)
button.Position = UDim2.new(0.9, -70, 0.8, -70)
button.BackgroundTransparency = 1  -- Removes background color
button.Parent = screenGui

-- ✅ Add rounded corners to make the button circular
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(1, 0)  -- Fully circular
uiCorner.Parent = button

-- ✅ Load Image AFTER forcing HttpService settings
spawn(function()
    local imageResult = fetchImage()
    if imageResult then
        button.Image = imageResult
    else
        warn("⚠️ Could not load external image.")
    end
end)

-- ✅ Right Shift Emulator Function
local function emulateRightShift()
    local VirtualInputManager = game:GetService("VirtualInputManager")
    if VirtualInputManager then
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.RightShift, false, nil)
        wait(0.1)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.RightShift, false, nil)
    else
        warn("⚠️ VirtualInputManager not available in this executor.")
    end
end

-- ✅ Clicking the button emulates Right Shift (to toggle script)
button.MouseButton1Click:Connect(function()
    emulateRightShift()
end)

-- ✅ Draggable Button Code
local UserInputService = game:GetService("UserInputService")
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    button.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

button.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = button.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

button.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        update(input)
    end
end)
